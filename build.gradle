apply plugin: 'java'

project.ext.sourceCompatibility = 1.6

task identify << {
    println "-----------------------------------"
    println "   _____               _ _          "
    println "  / ____|             | | |         "
    println " | |  __ _ __ __ _  __| | | ___     "
    println " | | |_ | '__/ _` |/ _` | |/ _ \\    "
    println " | |__| | | | (_| | (_| | |  __/    "
    println "  \\_____|_|  \\__,_|\\__,_|_|\\___|    "
    println ""
    println "-----------------------------------"
    println "Using build file '$buildFile.name' in '$buildFile.parentFile.name'."
}

allprojects {

    apply plugin: 'java'
    
    repositories {
        mavenCentral()
        maven {
            url "http://maven2.javacpp.googlecode.com/git/"
        }
        maven {
            url "http://maven2.javacv.googlecode.com/git/"
        }
    }

}

subprojects {

    dependencies {
        // stored at: %HOMEPATH%/.gradle/caches/artifacts-14/filestore
        compile group: 'org.sikuli', name: 'sikuli-api', version: '1.0.+'
        compile group: 'org.seleniumhq.selenium', name: 'selenium-java', version: '2.+'
        compile group: 'commons-collections', name: 'commons-collections', version: '3.+'
        compile group: 'junit', name: 'junit', version: '4.+'
    }

    task show << {
        println ""
        println "-----------------------------------------------"
        println "Project Name: " + projTitle
        println "Version: " + projVersion
        println "Home directory: "
        println "Build output: " + relativePath(compileJava.destinationDir)
        println "Resources output: " + relativePath(processResources.destinationDir)
        println "Test output dir: " + relativePath(sourceSets.test.output.classesDir)
        println "Test result dir: " + relativePath(testResultsDir)
        println "Report dir: " + relativePath(testReportDir)
        println "-----------------------------------------------"
    } 

    test {
        // this enables output in build/test-results directory
        testLogging {
            exceptionFormat "full"
            events "started", "passed", "skipped", "failed", "standardOut", "standardError"
        }
    }

}

project(':core') {
    project.ext.projTitle = 'WebDriver On Gradle'
    project.ext.projVersion = '0.99.0'
    
    jar {
        manifest {
            attributes 'Implementation-Title': project.projTitle, 'Implementation-Version': project.projVersion
        }
        // next 2 lines slows down build a lot but puts dependencies into the compiled .jar
        //dependsOn configurations.runtime
        //from { configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) } }
    }
}
    
project(':core:google') {
    dependencies {
        compile project(':core')
    }
    project.ext.projVersion = '0.99.2'
    project.ext.projTitle = 'WebDriver on Google'
        task packageTests(type: Jar) {
        from sourceSets.test.output
    }
}

project(':core:bing') {
    dependencies {
        compile project(':core')
    }
    project.ext.projVersion = '0.99.2'
    project.ext.projTitle = 'WebDriver on Bing'
    task packageTests(type: Jar) {
        from sourceSets.test.output
    }
}   

